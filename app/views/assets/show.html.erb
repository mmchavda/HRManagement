<div class="container mx-auto px-6">
  <div class="bg-white shadow-xl rounded-1xl overflow-hidden">
    <div class="flex items-center justify-between  bg-gray-200 px-6 py-4 border-b">
      <h2 class="text-xl font-semibold text-gray-600">Asset Information</h2>
      <div class="  flex justify-end space-x-4">
        <%= link_to asset_asset_assignments_path(@asset), class: "inline-flex items-center gap-2 bg-gray-100 hover:bg-gray-200 text-gray-700 px-5 py-2 rounded-md text-sm font-medium shadow-sm transition duration-200" do %>
          <i class="fas fa-history text-gray-700" aria-hidden="true"></i>
          <span>View Assignment History</span>
          <span class="sr-only">(history icon)</span>
        <% end %>
        <%= link_to assets_path, data: { turbo: false },
              class: "inline-flex items-center gap-2 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium border border-gray-300 shadow-sm transition duration-150" do %>
          <i class="fas fa-arrow-left" aria-hidden="true"></i>
          <span>Back to Assets</span>
        <% end %>
      </div>
    </div>
    <div class="p-6 space-y-8">
      <div>
          
        <div>
          <h2 class="text-xl font-semibold text-gray-600 mb-4 border-b pb-2">Basic Information</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Unique ID</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.unique_id %></p>
            </div>
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Asset Name</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.name %></p>
            </div>
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Asset Category</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.asset_category.name %></p>
            </div>
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Brand</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.brand.presence || "N/A" %></p>
            </div>
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Model</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.model.presence || "N/A" %></p>
            </div>
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Specifications</label>
              <p class="text-gray-700 text-base mt-1 whitespace-pre-line"><%= @asset.specifications.presence || "N/A" %></p>
            </div>
          </div>
        </div>

        <div>
          <h2 class="text-xl font-semibold text-gray-600 mb-4 border-b pb-2">Technical Details</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Serial Number</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.serial_number.presence || "N/A" %></p>
            </div>
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Location</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.location.presence || "N/A" %></p>
            </div>
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Purchase Date</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.purchase_date ? @asset.purchase_date.strftime('%B %d, %Y') : 'N/A' %></p>
            </div>
            <div>
              <label class="text-gray-500 text-sm uppercase tracking-wide">Warranty Expiry</label>
              <p class="text-gray-700 text-base mt-1"><%= @asset.warranty_expiry ? @asset.warranty_expiry.strftime('%B %d, %Y') : 'N/A' %></p>
            </div>
          </div>
        </div>

        <div>
          <h2 class="text-xl font-semibold text-gray-600 mb-4 border-b pb-2">Assignment & Status</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <div>
                <label class="text-gray-500 text-sm uppercase tracking-wide">Asset Status</label>
                <p class="text-gray-700 text-base mt-1"><%= @asset.status&.humanize || "N/A" %></p>
              </div>
              <div>
                <label class="text-gray-500 text-sm uppercase tracking-wide">Assigned To</label>
                <p class="text-gray-700 text-base mt-1"><%= @asset.current_assignment.present? ? @asset.current_assignment.user.full_name : 'N/A' %></p>
              </div>
              <div>
                <label class="text-gray-500 text-sm uppercase tracking-wide">Condition</label>
                <p class="text-gray-700 text-base mt-1"><%= @asset.condition.presence || "N/A" %></p>
              </div>
            </div>
          </div>
        </div>

        <div>
          <h2 class="text-xl font-semibold text-gray-600 mb-4 border-b pb-2">Assign / Unassign Assets</h2>

          <div data-controller="toggle" class="px-4 py-6">
            <!-- Toggle Buttons -->
            <div class="flex gap-4 mb-6">
              <% if @asset.status == "available" || @asset.status == "in_maintenance" %>
                <button type="button" data-action="click->toggle#showAssign" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 text-sm font-medium">
                  <i class="fas fa-user-plus mr-1"></i>Assign Asset
                </button>
              <% elsif @asset.status == "assigned" %>
                <button type="button" data-action="click->toggle#showUnassign" class="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 text-sm font-medium">
                  <i class="fas fa-user-minus mr-1"></i>Unassign Asset
                </button>
              <% end %>
            </div>

            <%# Assign Form %>
            <% if @asset.status == "available" || @asset.status == "in_maintenance" %>
              <div data-toggle-target="assignSection" class="hidden">
                <div class="bg-white p-6 border max-w-xl mx-auto">
                  <h3 class="text-xl font-semibold text-gray-800 mb-4">Assign Asset: <%= @asset.name %></h3>

                  <%= form_with url: asset_asset_assignments_path(@asset), method: :post, local: true do |f| %>
                    <div class="mb-4">
                      <%= label_tag :user_id, "Select User", class: "block text-sm font-medium text-gray-700 mb-1" %>
                      <%= select_tag :user_id, options_from_collection_for_select(@users, :id, :full_name), prompt: "Choose a user", class: "w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" %>
                    </div>

                    <div class="mb-4">
                      <%= label_tag :comments, "Comments (optional)", class: "block text-sm font-medium text-gray-700 mb-1" %>
                      <%= text_area_tag :comments, nil, rows: 3, class: "w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-gray-500 focus:border-gray-500 sm:text-sm" %>
                    </div>

                    <div class="flex justify-end">
                      <%= submit_tag "Assign Asset", class: "bg-gray-600 hover:bg-gray-700 text-white px-5 py-2 rounded-md text-sm font-medium shadow-sm" %>
                    </div>
                  <% end %>
                </div>
              </div>
            <% end %>

            <%# Unassign Form %>
            <% if @asset.status == "assigned" && @asset_assignment.present? %>
              <div data-toggle-target="unassignSection" class="hidden">
                <div class="bg-white p-6 border max-w-md mx-auto mt-4">
                  <h3 class="text-xl font-semibold text-gray-800 mb-4">Confirm Unassign</h3>
                  <p class="text-gray-600 mb-4">Are you sure you want to unassign this asset?</p>

                  <%= form_with(model: @asset_assignment, url: unassign_asset_path(@asset), method: :patch, local: true) do |form| %>
                    <div class="mb-4">
                      <%= form.label :status, "New Status", class: "block text-sm font-medium text-gray-700 mb-1" %>
                      <%= form.select :status, options_for_select(Asset.statuses.keys.reject { |s| s == "assigned" }, @asset.status), {}, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-gray-500" %>
                    </div>

                    <div class="flex justify-end">
                      <%= form.submit "Unassign Asset", class: "bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm font-medium" %>
                    </div>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>